/**
@license Copyright Â© 2019 xxx. All Rights Reserved.
 */
function init(n,t,i){sessionStorage.setItem("svg_width",n);sessionStorage.setItem("svg_height",t);sessionStorage.setItem("PageNum-"+i+"-0",1);sessionStorage.setItem("vNo",1);sessionStorage.setItem("excludeId_1",i)}function ClickExternalSearch(n){var t,i;const r=$(".RectSelect");for(t="",i=0;i<r.length;i++)t+=encodeURIComponent($("#text-"+r[i].id).text())+"+";t=t.slice(0,-1);window.open(n+t,"_blank")}function RectMouseenter(n){$("#"+n).css({fill:RectFill,stroke:RectStroke})}function RectMouseleave(n){var t=$("#"+n).attr("class");t==="RectSelect"?$("#"+n).css({fill:RectFill_Mouseleave}):$("#"+n).css({fill:RectFill_Mouseleave,stroke:RectStroke_Mouseleave})}function TextMouseenter(n){var t=n.substring(n.indexOf("-")+1);$("#"+t).css({fill:RectFill,stroke:RectStroke})}function TextMouseleave(n){var t=n.substring(n.indexOf("-")+1),i=$("#"+t).attr("class");i==="RectSelect"?$("#"+t).css({fill:RectFill_Mouseleave}):$("#"+t).css({fill:RectFill_Mouseleave,stroke:RectStroke_Mouseleave})}function NextTextMouseenter(n){var t=n.substring(n.indexOf("-")+1);NextRectMouseenter(t)}function NextTextMouseleave(n){var t=n.substring(n.indexOf("-")+1);NextRectMouseleave(t)}function NextRectMouseenter(n){$("#"+n).css({fill:"#0069D9"})}function NextRectMouseleave(n){$("#"+n).css({fill:"#007BFF"})}function ClickText(n,t){ClickRect(n.substring(n.indexOf("-")+1),t)}function ClickRect(n,t){var i=$("#"+n),s=i.attr("class"),h=i.parent().attr("id"),r="GrID-"+n,o;if(s==="RectSelect")i.attr("class","RectNonSelect"),console.log("ClickRect-1"),N(r);else{i.attr("class","RectSelect");console.log("ClickRect-2");var u=n.split("-"),f=u[0],e=u[1];F(h,r);o="PageNum-"+f+"-"+e;console.log("ClickRect-3");Q(r,n,0,f,e,t,o)}}function ClickNextText(n,t){ClickNext(n.substring(n.indexOf("-")+1),t)}function ClickNext(n,t){var i=n.split("-"),f=i[1],r=i[2],e=$("#"+n),o=e.parent().attr("id"),u="PageNum-"+t+"-"+r,s=Number(sessionStorage.getItem(u));Q(o,n,s,f,r,t,u)}function Q(n,t,i,r,u,f,e){var o="/MapPR/"+r+"?p="+i;console.log("url="+o);d3.json(o).then(function(o){M(n,t,i,r,u,f,e,o)})}function M(n,t,i,r,u,f,e,o){var s,c,l,h;console.log("M()");s=n+"-"+i;console.log("GrIDpage="+s);c=sessionStorage.getItem(s);c===null?(console.log("M() 1"),l=sessionStorage.getItem("excludeId_"+u),h="/Map/"+r+"?p="+i,l!==null&&(h+="&e="+l),console.log("url="+h),d3.json(h).then(function(u){sessionStorage.setItem(s,JSON.stringify(u));E(u,t,n,i,r,f,o)})):(console.log("M() 2"),E(JSON.parse(c),t,n,i,r,f,o));sessionStorage.setItem(e,i+1)}function E(n,t,i,r,u,f,e){var s,a,v,o,c,y,d;console.log("E()");console.log(n);console.log(n.wordList);const h=n.wordList,ut=n.nextAvailable,g=d3.select("#s");r===0?(s=g.append("g"),s.attr("id",i)):s=d3.select("#"+i);const w=$("#"+t),b=Number(w.attr("x")),l=Number(w.attr("y")),nt=Number(w.attr("width")),ft=l+15,et=b+nt,p=b+nt+30;a=r===0?p+20:b;const tt=30,it=a+10,k=l+tt,rt=l+50;if(v=Number(sessionStorage.getItem("vNo")),r===0&&(v+=1,sessionStorage.setItem("vNo",v)),sessionStorage.setItem("excludeId_"+v,u),S(r,s,et,ft,p),o=0,c=0,console.log("E() 1"),h.length>0){for(console.log("E() 2"),y=0;y<h.length;y++)o<h[y].r_w&&(o=h[y].r_w);o+=40;c=h.length*40+(r===0?80:tt)}else console.log("E() 3"),o=200,c=70;e.i>0&&(e.adverTitle_r_w>o&&(o=e.adverTitle_r_ww),c=c+40);R(r,s,i,p,l,o,c);G(g,p,o,l,c);d=P(s,e,a,k,n);I(h,r,s,a,k,v,d,it,rt,u);X(r,ut,s,i,a,k,h.length,d,it,rt,u)}function S(n,t,i,r,u){console.log("S()");n===0&&t.append("line").attr("x1",i).attr("y1",r).attr("x2",u).attr("y2",r).attr("class","RectBorder")}function R(n,t,i,r,u,f,e){if(console.log("R()"),n===0)t.append("rect").attr("id","Border"+i).attr("x",r).attr("y",u).attr("width",f).attr("height",e).attr("class","RectBorder");else{const n=$("#Border"+i);var o=Number(n.attr("width"));o<f&&n.attr("width",f);const t=Number(n.attr("height"));n.attr("height",t+e)}}function G(n,t,i,r,u){console.log("G()");const o=sessionStorage.getItem("svg_width"),s=sessionStorage.getItem("svg_height"),f=t+i+100,e=r+u+100;o<f&&(n.attr("width",Number(f)),sessionStorage.setItem("svg_width",f));s<e&&(n.attr("height",Number(e)),sessionStorage.setItem("svg_height",e))}function P(n,t,i,r,u){if(console.log("P()"),t.i>0){var e=n.append("text").attr("id","pr-1").attr("x",i).attr("y",r).attr("class","PrText"),f=e.append("a").attr("href","#").attr("onclick","ClickPrRelation('"+t.au+"', "+t.u+", "+t.b+", "+t.a+", "+u.wordId+");return false;");return f.append("tspan").attr("x",i).attr("y",r).text("[PR] "+t.adverTitle1),f.append("tspan").attr("x",i).attr("y",r+20).text(t.adverTitle2),40}return 0}function I(n,t,i,r,u,f,e,o,s,h){if(console.log("I()"),n.length<1)console.log("I() 1"),t===0&&i.append("text").attr("x",r).attr("y",u).attr("class","HitsText").text("0 hits. Not calculated...");else{console.log("I() 2");for(var c=0,c=0;c<n.length;c++)console.log("I() 2-1"),i.append("rect").attr("id",n[c].id+"-"+f).attr("onmouseenter","RectMouseenter(this.id)").attr("onmouseleave","RectMouseleave(this.id)").attr("onclick","ClickRect(this.id, '"+h+"')").attr("x",r).attr("y",u+c*40+e).attr("width",n[c].r_w).attr("height",30).attr("class","RectNonSelect"),console.log("I() 2-2"),console.log("wordList[i2].id = "+n[c].id),console.log("vNo = "+f),console.log("No = "+h),console.log("text_x = "+o),console.log("text_y = "+s),console.log("pr_y = "+e),console.log("wordList[i2].word = "+n[c].word),i.append("text").attr("id","text-"+n[c].id+"-"+f).attr("onmouseenter","TextMouseenter(this.id)").attr("onmouseleave","TextMouseleave(this.id)").attr("onclick","ClickText(this.id, '"+h+"')").attr("x",o).attr("y",s+c*40+e).attr("class","RectText").text(n[c].word),console.log("I() 2-3")}}function X(n,t,i,r,u,f,e,o,s,h,c){if(console.log("X()"),n===0)t&&(i.append("rect").attr("id","NextRect"+r).attr("onmouseenter","NextRectMouseenter(this.id)").attr("onmouseleave","NextRectMouseleave(this.id)").attr("onclick","ClickNext(this.id, '"+c+"')").attr("x",u).attr("y",f+e*40+o).attr("width",150).attr("height",30).attr("class","RectNext"),i.append("text").attr("id","text-NextRect"+r).attr("onmouseenter","NextTextMouseenter(this.id)").attr("onmouseleave","NextTextMouseleave(this.id)").attr("onclick","ClickNextText(this.id, '"+c+"')").attr("x",s).attr("y",h+e*40+o).attr("class","RectTextNext").text("View next 30"));else{const n=$("#NextRect"+r),i=$("#text-NextRect"+r);t?(n.attr("x",u),n.attr("y",f+e*40+o),i.attr("x",s),i.attr("y",h+e*40+o)):(n.remove(),i.remove())}}function N(n){var t,i,r,u;for(console.log("N()"),t=JSON.parse(sessionStorage.getItem("GrIdArrayList")),C(t,n),i=0;i<t.length;i++)t[i][0]===n&&t.splice(i,1);for(r=0;r<t.length;r++)t[r][0]===n&&t.splice(r,1);for(u=0;u<t.length;u++)t[u][1]===n&&t.splice(u,1);sessionStorage.setItem("GrIdArrayList",JSON.stringify(t))}function C(n,t){console.log("C()");for(var i=0;i<n.length;i++)n[i][0]===t&&C(n,n[i][1]);$("#"+t).remove()}function F(n,t){console.log("F()");var r=[n,t],i=JSON.parse(sessionStorage.getItem("GrIdArrayList"));i!==null?i.push(r):i=[r];sessionStorage.setItem("GrIdArrayList",JSON.stringify(i))}